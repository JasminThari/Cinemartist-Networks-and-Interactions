Michael MacCauley, a former NYPD officer turned insurance agent, takes the same daily train commute on the Hudson Line from Tarrytown to Grand Central Terminal. He is abruptly laid off from his job, endangering his family's financial security. Waiting to reveal his dismissal to his wife and son, he instead confides in Murphy, his ex-partner still on the police force. On the train home, Michael meets a mysterious woman, Joanna, who proposes a "hypothetical" situation: she asks him to locate "Prynne," the alias of an unknown passenger whom Joanna claims has a stolen item. Joanna tells Michael that he will find $25,000 in the bathroom and be paid a further $75,000 when his task is done. Alluding to Michael being a former cop, she departs, and he finds the $25,000.

Michael attempts to leave the train with the money, but he is stopped by a young teenager with an envelope containing his wife's wedding ring, which she tells him is a warning. Unable to reach his wife by phone, he discreetly approaches fellow commuter Walt, writing a note on his newspaper to contact the police. Michael leaves Murphy a voicemail describing the situation and receives a call from Joanna threatening him and his family. She tells him the train is rigged with hidden cameras and to look outside, where he sees Walt pushed in front of a moving bus and killed. Joanna points Michael to a GPS tracker in his jacket to plant on Prynne.

Michael induces a conductor to make random security searches, saying that he has observed suspicious activity by some of the passengers. But when the conductor tries to search a woman's bag, she protests loudly. A man immediately leaves the car, and Michael follows, but the man attacks him, and Michael plants the tracker on him. Murphy calls back and explains that Prynne is a key witness in the supposed suicide of city official Enrique Mendez, leading Michael to realize that Prynne will be killed and that Michael is being set up. In a deserted carriage, Michael discovers the body of the man he planted the tracker on and a badge revealing he was an FBI agent. Joanna calls, chastising Michael for marking the wrong person and warning that another passenger reported his suspicious activities to police, who stop the train to investigate. Michael hides with the corpse underneath the carriage but loses the $25,000.

Sabotaging the train's air conditioning, he forces the remaining passengers into the last carriage and realizes another passenger, Oliver, killed the FBI agent. Oliver reveals that he received the same instructions for $100,000 but with orders to kill Prynne once Michael identified him. They fight, and Michael throws Oliver out of a window, thereby killing him. "Prynne" is revealed to be a 16-year-old girl named Sofia, who is holding incriminating information on powerful people; the agent was escorting her to witness protection at the train's final stop. Sofia reveals that Enrique, her cousin, was murdered by police officers.

Joanna calls to force Michael to kill Sofia for the sake of his family, but he refuses, and Joanna detonates explosives to derail the train and kill everyone aboard. Michael saves the passengers by unhooking the final carriage at a curve in the tracks, but a conductor, Sam, is killed. Michael instructs the passengers to block the carriage windows with wet newspapers before a massive police force arrives. Assuming that Michael is holding the train hostage, authorities send Murphy to negotiate with him. Entering the carriage, Murphy unknowingly reveals himself as the rogue cop who killed Enrique, and he and Michael fight hand-to-hand. Michael removes Murphy's electronic ID tag, which identifies him as a "friendly" to the police snipers' thermal vision, resulting in Murphy being mistaken for Michael and shot dead.

Sofia tells the FBI what she knows, and Michael is exonerated by the other passengers while the FBI rescues his family. His former captain admits that Murphy and other corrupt officers had been under investigation and offers Michael his job back. Michael reveals that he kept the incriminating hard drive Sofia gave him. Some time later, Joanna is on a train back from Chicago when Michael confronts her, showing her his detective's badge and preparing to arrest her.

