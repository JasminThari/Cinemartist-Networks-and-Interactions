Spencer and Laura Peterson, with their children Luke and Anna, are coping with the loss of their eldest son, Caleb, to the war in Afghanistan. They are visited by David Collins, a former U.S. Army sergeant who claims he was Caleb's best friend. He tells the family he wanted to visit them as a way to help Caleb take care of them. He is polite and friendly, and Laura invites him to stay as long as he wishes.

David hears of Spencer's troubles at work, and he sees Luke return home with a bruise on his face, caused by bullies at school. The next day, David and Luke follow the bullies to a bar, where David beats them up. He then uses his knowledge of the law, as well as a bribe, to convince the bartender not to tell anyone. That evening, David goes to a Halloween party with a reluctant Anna, where he makes a good impression with her friends, and later saves her friend Kristen from her violent ex-boyfriend. David and Kristen have sex, then David asks Anna's friend Craig where he can buy a gun. On their way home, Anna offers to make David a mix CD.

David gives Luke advice on dealing with bullies and gives him his butterfly knife. He meets Craig and his friend to buy the gun, but kills them and steals their weapons. When a suspicious Anna calls the military base to ask about David, she is told that he presumably died a week earlier. The call alerts a private corporation called the KPG, headed by Major Carver, who assembles a special forces team and heads for Peterson's home. Anna then learns about Craig's death, and that her boyfriend Zeke has been blamed for it. It is revealed that Spencer's boss died under mysterious circumstances, giving Spencer the promotion he always wanted. Anna asks Luke to research the numbers David has called on his phone.

At school, one of the bullies assaults Luke again, but he fights back by punching him in the face and hitting him with a yardstick. After they are both sent to the principal's office, David arrives and coerces the principal to give Luke a month of after-school detention, and threatens litigation if the principal expels him. Luke tells David of Anna's suspicions, but promises not to investigate any further or tell anyone else. While David helps Laura with the laundry, Major Carver's team attacks the house, but David kills all of them except for Carver. His cover blown, David stabs Laura with a kitchen knife. He then drives away, and kills Spencer as well.

Carver picks up Anna and informs her of her parents' deaths. He reveals that David was a test subject in a military medical experiment and was "programmed" to kill anyone who might compromise his identity, and is unlikely to be able to stop even if he wanted to. Meanwhile, David shoots Kristen in the chest and blows up the restaurant where she and Anna work. He goes to the school to kill Luke. Carver and Anna arrive at the school before David, and enter a haunted house set up for the Halloween dance. David turns off the lights and plays Anna's mix CD, then kills Luke's teacher and Carver with a boxcutter. Anna shoots David with Carver's gun, but David stabs her in the leg and attempts to choke her as the gun misfires and damages a light, starting a fire. Luke stabs David twice with the butterfly knife, which frees Anna. David tells Luke that he did the right thing and gives him a thumbs-up before collapsing.

Sitting in an ambulance, Anna and Luke overhear the firefighters say that only two corpses were recovered. As several firefighters exit the school, Anna notices one of them is limping; he turns to face her, and it is David using the disguise to quietly escape the scene.

