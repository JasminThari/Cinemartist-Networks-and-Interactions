Years ago, King Harold and Queen Lillian were about to sign the kingdom of Far Far Away over to Rumpelstiltskin ("Rumpel") in exchange for lifting the curse of their daughter, Princess Fiona â€“ cursed to transform into an ogre nightly and locked in a tower until rescued by her "true love". Before signing, news arrived that she had been saved,{{efn|As depicted in the 2001 film ''Shrek''}} and they canceled the deal. In the present day, Rumpel has become an outcast and wishes that Fiona's rescuer, Shrek, was never born.

Meanwhile, Shrek has grown increasingly tired of being a family man and celebrity, longing for the days when he was feared and had privacy. While celebrating his children's first birthday in Far Far Away, an escalating series of mishaps enrages Shrek, causing him to storm out in anger and lash out at Fiona. Having witnessed the outburst, Rumpel follows Shrek into the forest and stages a scene of being in distress, prompting Shrek to help. Invited inside Rumpel's carriage, Shrek laments that he is no longer a "real ogre". Rumpel offers him a deal to receive a day as a "real ogre" in exchange for a day from his childhood. Shrek signs a contract fulfilling this wish, and is whisked away into an alternate reality.

Now feared by the villagers, Shrek causes some lighthearted mischief, until he discovers that Fiona is a fugitive and his swamp is deserted and desolate. Captured by witches, Shrek is taken to Rumpel, who is now the king of Far Far Away. Rumpel reveals to Shrek that he took the day he was born, meaning Shrek never existed in this altered timeline. Consequently, Harold and Lillian were forced to sign the kingdom over to Rumpel, causing them to disappear. When the day ends, Shrek will cease to exist.

Shrek escapes Rumpel's castle with Donkey, who is initially terrified of Shrek but befriends him after seeing him cry over his erased history. Donkey helps Shrek find a hidden exit clause; the contract can be nullified by "true love's kiss". The pair soon encounter a still-cursed Fiona leading an army of ogres in a resistance against Rumpel, and a lazy and overweight Puss in Boots being kept as Fiona's pet. Shrek unsuccessfully tries to woo Fiona, who has since lost hope of finding true love after not being rescued, and is too busy preparing an ambush on Rumpel. Puss encourages Shrek to continue pursuing Fiona.

During the ambush, most of the ogres are captured by the Pied Piper, who was hired by Rumpel, but Shrek and Fiona escape with Puss and Donkey. Shrek insists that Fiona kiss him, assuring her that it will fix everything; she reluctantly obliges, but to Shrek's surprise, nothing happens. Later on, Rumpel publicly offers a wish to anyone who brings him Shrek, and after hearing this, Shrek turns himself in. Rumpel is forced to grant Shrek's wish, and he uses it to free the other ogres. As Shrek is locked up, Rumpel reveals that Fiona had been captured and not released, since she is not "all ogre". Donkey, Puss, and the freed ogres storm the castle; they capture Rumpel and defeat his witch army, while Shrek and Fiona take down Dragon.

As the sun rises, Shrek begins to fade from existence, but Fiona, having fallen in love with him, kisses him just before he disappears. Seeing that she is still an ogre in the sunlight, Fiona realizes that her curse was broken and that she has assumed "love's true form". The alternate reality disintegrates, making everyone disappear, and Shrek finds himself transported back to the original timeline at the moment before he lost his temper at the party. Instead of lashing out, Shrek embraces his family and friends with a newfound appreciation for them.

