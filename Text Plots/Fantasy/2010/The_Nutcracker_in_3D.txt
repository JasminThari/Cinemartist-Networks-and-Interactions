In 1920s Vienna during the Christmas season, Mary lives with her parents Joseph and Louise, and younger brother Max. She is upset that her parents are attending a party that night, as she wants the whole family to be together for Christmas. Uncle Albert arrives and gifts both her and Max a dollhouse and a nutcracker doll nicknamed NC, whom Mary immediately takes a liking to. That night, NC comes to life in front of Mary and grows to human height. He tells her that he must talk to his friends in the dollhouse, which is in the sitting room by the Christmas tree. They go downstairs and Mary finds that the sitting room has grown to an enormous size so that they appear to be the height of toys. In the dollhouse, Mary meets NCs friends; Gielgud, a gentlemanly chimpanzee; Tinker, a pernickety opera singer; and Sticks, a drummer boy.

After climbing the Christmas tree, Mary meets the Snow Fairy, who resembles her mother. The Snow Fairy tells Mary that NC is in fact a prince who had his kingdom taken over by the anthropomorphic Rat King and his cruel mother, The Rat Queen, who was also the one that turned him into a nutcracker. She manages to temporarily turn him back into a boy due to Mary's belief and the two briefly dance before finding his city. Since NC was turned into a nutcracker, the Rat King has been oppressing his people, and forcing them to work in factories where the children's toys are burnt to form dark clouds over the city to block out sunlight, which he is afraid of. Mary suggests that they destroy the factories to scare him away. Unbeknownst to them, two of the Rat Kings spies report back to tell the Rat King that NC is alive and a boy again. The Rat Queen turns NC back into a nutcracker, then sends the Rat Dogs, a pack of robotic Rottweilers, to cut down the Christmas tree. When the tree falls, Mary suddenly wakes up in her own bed and runs downstairs to get NC. Her parents do not believe her when she tells them the events of the night.

The next evening, NC comes to life again and tells Mary that he intends to round up an army to fight against the Rat King. Max wakes up and agrees to join the fight with them. NC goes downstairs ahead of them, to gather his friends but is kidnapped. When Mary and Max go downstairs, they find that NC, Tinker and Sticks are being held captive in the fireplace by the Rat King and his minions, who kidnap the toys and lure Max back to the city. Mary discovers Gielgud, who evaded capture, and they find a portal to the city in the house's attic, and after stealing disguises from a rat, search for their friends. They find the Rat King and Max in the city centre where toys are being taken from children to be burned. Horrified, Max asks to be returned home, but the Rat King imprisons him in his castle. They sneak into one of the smoke factories where they find Sticks, Tinker and an apparently lifeless NC.

Mary rescues NC from being burned and tells him that she loves him, which breaks the curse, restoring his life and into being a boy permanently. The factory workers, seeing their prince alive, begin to fight back against the rats while Mary and NC attempt to shut down the factory. The Rat King and Queen board a helicopter, kidnapping Mary and Max. Gielgud and NC take chase and fight the King while Max successfully lands the aircraft in a pile of toys. The King and Queen revert to their original rat forms and flee into the sewers. NC is crowned king and peace is restored in the kingdom as everyone celebrates. The Snow Fairy reappears and tells Mary it is time for her to return home, though she is reluctant to leave. Before she departs, NC promises that they will meet again.

Mary wakes in her room, where her parents apologise for their earlier criticisms and promise to spend more time with her. She goes downstairs to Uncle Albert, who introduces her to his new neighbour: a boy her age, who resembles the Nutcracker Prince and asks to be called NC. They become friends and go ice-skating together.

