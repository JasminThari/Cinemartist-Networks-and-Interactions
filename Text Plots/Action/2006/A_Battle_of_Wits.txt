The film is set in China in 370 BC during the Warring States period. A massive army from the Zhao state is on its way to attack the Yan state. Liang, a city-state on the Zhao–Yan border, is in peril of being conquered by the Zhao army. Ge Li, a Mohist, comes to Liang to help defend the city. Although the King of Liang has already planned for peace talks with the invaders, Ge Li manages to convince him and the people of Liang to put up resistance by warning them of the consequences of surrendering. He also promises the King that the invaders will give up on Liang if they fail to conquer it within a month, because their main target is actually the Yan state. The King has doubts about Ge Li's idea but still puts Ge in command of his army.

Ge Li creates a bulwark and various traps to halt the Zhao army's advance. When he insists that Zituan lead the archers, Liang Shi (the Liang prince) is angered because he sees Zituan's archery skill as inferior to his. Even though Zituan later proves to be a better archer, Ge Li's style of working puts him at odds with Liang Shi and the other Liang generals. Ge Li also briefly meets Xiang Yanzhong, the commander-in-chief of the Zhao army, for a board game outside the city to understand each other better. During the first Zhao attack, Ge Li's defence tactics worked well—a Zhao general was killed and the invaders were forced to retreat—but the Liang forces also suffered losses from a skirmish with Zhao infiltrators inside the city. Ge Li's success earns him the support of the people and he becomes a highly revered hero. Yiyue, a female cavalry commander, falls in love with Ge Li. However, Ge Li is reluctant to accept her feelings for him and tries to draw boundaries between them. One night, Ge Li and Yiyue scout the Zhao camp and discover that the enemy is digging tunnels to bypass their city's defences. Ge Li used that to his advantage by luring the Zhao soldiers into an ambush and then sealing the tunnel exits. The Liang general Niu Zizhang massacres the captured Zhao soldiers even though they were promised that their lives would be spared if they laid down their weapons.

In the meantime, the King feels threatened when he sees Ge Li's growing popularity, so he plots to have Ge stripped off his post and executed on false charges. At the same time, the Liang forces receive news that the Zhao army has retreated. Ge Li plans to leave Liang since his mission is complete. He goes out to check that the Zhao army is indeed retreating. When he returns, he is stopped outside the gates and is accused of starting a war under false pretences and plotting to seize the throne. Just as the Liang soldiers are about to kill Ge Li, Liang Shi shows up, pretends to fight with Ge, and secretly tells Ge to take him hostage in order to buy time for Ge to escape. Ge Li manages to escape but Liang Shi is killed by a rain of arrows meant for Ge Li. Meanwhile, Ge Li's supporters, including Yiyue, are falsely accused of plotting a rebellion against the King and are arrested and tortured. Yiyue denounces the King and is sentenced to death. The King also has her rendered mute to prevent her from speaking up against him. Zituan refuses to turn against Ge Li, so he cuts off his right arm and leaves the Liang army.

One night, just as Yiyue is about to be executed, the Zhao army launches a surprise attack and completely catches the Liang defenders off guard. She is taken back to the prison. Instead of focusing on fighting the invaders, the King orders his soldiers to kill those who try to escape from the city. Liang eventually falls to the Zhao army, and the King and his people are captured. Zituan and his archers manage to escape from Liang, and they join Ge Li outside the city. Xiang Yanzhong sends a message to Ge Li, in which he threatens to kill the people of Liang if Ge does not return to Liang to meet him. Ge Li returns to Liang alone and agrees to play the board game again with Xiang Yanzhong inside a tower. They agree that only the winner can leave the tower. Meanwhile, Zituan and his men flood the areas guarded by Zhao forces and launch an attack. Seeing that reinforcements have arrived, the people of Liang rise up against the Zhao invaders and succeed in defeating them and driving them out of the city. Xiang Yanzhong refuses to leave the tower because he feels that he has lost. After the battle, the King passes by the tower, sees Xiang Yanzhong, and orders Xiang to be killed. While the people of Liang rejoice in their victory, Ge Li rushes to the flooded prison to find Yiyue but arrives too late because she was unable to call out to him for help and has already drowned.

Before the film ends, Ge Li leaves with some orphans to promote peace among the various warring states. The King of Liang meets his downfall five years later: The people can no longer stand his cruelty so they overthrow and execute him. Eventually, the Qin state conquers all the other states and unites China under the Qin dynasty.

