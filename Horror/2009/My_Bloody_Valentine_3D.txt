On Valentine's Day 1997, six miners are trapped underground by an explosion at the Hanniger mine in the small mining community of Harmony. By the time rescuers reach the miners, they find only comatose Harry Warden still alive. Further investigation reveals that Warden killed the other miners to conserve oxygen. Tom Hanniger, son of the mine's owner, is blamed for the explosion as he forgot to vent the methane lines that caused the collapse.

One year later, Warden has awakened from his coma and is now murdering as an act of revenge. He starts by killing numerous patients and staff at the hospital where he was a patient, leaving a victim's heart in a box of chocolates. While Tom, his girlfriend Sarah, their friends Irene and Axel, and other teenagers party inside the mine, Warden – wearing mining gear and a gas mask – attacks them with a pickaxe. Sarah, Irene, and Axel escape but Tom is left behind with Warden. Sheriff Burke arrives and shoots Warden before he can kill the severely traumatized Tom, but Warden staggers away deeper into the mine.

Ten years later, Tom returns to Harmony after his father dies. He is selling the mine, which angers mine manager Ben Foley. Axel, now the town's sheriff, has married Sarah but is having an affair with her coworker Megan. At the motel where Tom is staying, a masked assailant murders Irene and two other people. Camera footage from the scene reveals the killer dressed as a miner, starting rumors that Warden has returned. Axel receives a chocolate box containing Irene's heart. Meanwhile, Tom reconnects with Sarah and apologizes for his ten-year absence.

Looking for Foley in the mine, Tom is locked inside a utility cage by the Miner, who murders the worker accompanying Tom and vanishes before help arrives. Tom insists that Warden has returned, but Axel reveals that Foley and Sheriff Burke found and killed Warden after his attack ten years ago. The group visits the woods where Warden's body was buried, but find that the grave is empty. Tom resolves to track down and stop Warden. Searching the woods, he finds the shack that Axel and Megan have been using for their affair. That night, the Miner kills Foley and leaves his body in Warden's grave. Axel realizes the killer must be one of the few people aware of the grave, and he becomes increasingly suspicious of Tom.

The Miner attacks Sarah and Megan, killing Megan just before Axel arrives. Sarah is hospitalized with minor wounds. The Miner then kills former sheriff Burke as well as the maid of Axel and Sarah's home. Tom shows up at the hospital, telling Sarah he has to show her something he found in Axel's cabin. She checks herself out and accompanies Tom. As they drive, Tom suggests that Axel is the killer. Axel calls and urges Sarah to get away from Tom, whom he says is the killer; Axel has discovered that Tom spent the last seven years in a mental institution. Tom becomes increasingly agitated and Sarah, believing Axel, grabs the wheel and crashes the car before escaping into the woods.

Sarah hides in Axel's cabin. There she discovers evidence of Axel's affair and a tower of empty valentine gift boxes. The Miner appears and chases her into the mine. She is hiding in the mine when Axel arrives, and Sarah grabs his gun. Tom shows up, and Sarah holds the two men at gunpoint as they each accuse the other of being the killer. Tom, however, mentions the way Megan was killed, inadvertently revealing he is the killer. As Sarah points the gun at him, Tom hallucinates, revealing the Miner is his split personality. A flashback shows him digging up Warden's mining gear and committing the murders. After a struggle, Sarah shoots Tom, and the bullet strikes a fuel tank, which explodes. Sarah and Axel are rescued from the resulting cave-in. Tom also survives, murdering the rescue worker who finds him and escaping in the worker's gear.

