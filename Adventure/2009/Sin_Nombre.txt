Willy, nicknamed ''El Casper'', is a member of the Mara Salvatrucha gang and lives in Tapachula, a Mexican town near the border with Guatemala. He introduces a young boy into his gang, and the boy is given the nickname ''Smiley'' after a violent initiation. Casper later helps Smiley to complete this initiation by helping him execute a rival gang-member.

Casper is romantically involved with a girl, Martha Marlen. Fearing for her safety, he keeps the relationship a secret from his gang, but his double life causes his gang to doubt his loyalty. When Martha follows Casper to a gathering of his gang, the gang leader, Lil Mago, escorts her out, despite Casper's misgivings. Mago attempts to rape Martha and accidentally kills her. Later, he blithely tells Casper that he will find another girl.

Shortly afterward, Mago brings Casper and Smiley to La Bombilla, a location along the train tracks where potential undocumented immigrants stow away on passing trains on their way to the United States. Among the immigrants is a Honduran family introduced earlier, consisting of the teenage girl Sayra, her father, and her uncle, who are on their way to relatives in New Jersey. Lil Mago, Casper, and Smiley rob the passengers for any money they have until Lil Mago spots Sayra and attempts to rape her. Casper intervenes, killing Mago and then sending Smiley off.

Smiley goes back to the gang and reports Mago's death. The gang's new leader, El Sol accuses Smiley of collusion, to which Smiley timidly protests and begs to be sent to kill Casper to prove his loyalty. El Sol agrees and Smiley travels north to track down Casper. On the train, the still distraught Casper is avoided by other passengers. When some try to throw him off the train, Sayra warns Casper. She keeps on approaching him, despite her father's warnings. Casper's knowledge from previously smuggling gang members and avoiding the police proves useful, as he eludes his pursuers. He is finally accepted by Sayra's family but decides to leave the train while the others are sleeping. Unbeknownst to him, Sayra follows him. Meanwhile, her father and uncle decide to continue the journey.

Traveling north on a car transport organized by a friend of Casper, Casper and Sayra barely escape a trap laid for them and enter an immigrant shelter, where Sayra sees a familiar face. She is informed that her father has died and her uncle has been caught. In disbelief, she rushes off to cry at the chapel, where Casper comforts her. They reach a river that constitutes the border to the United States. A coyote agrees to take them across one by one. Casper pays the man with his camera containing the cherished pictures of his girlfriend and insists that Sayra go first. When she is halfway across, the gang appears and begins to chase Casper. He flees the pursuing gang but runs into Smiley, who shoots him once, then slowly two more times. The others arrive and proceed to empty their magazines into Casper, while Sayra struggles to hold onto the raft and screams.

The closing scenes show Sayra phoning her father's new family from outside an American mall, her uncle setting off on another attempt to cross the border, and Smiley having his lip tattooed as a sign of his loyalty to the gang.

