The film is set in China in the 1860s during the Taiping Rebellion against the ruling Qing Empire. Pang Qingyun, the commander of an imperial battalion, is the sole survivor after a battle between imperial and rebel forces. He meets and befriends Zhao Erhu and Jiang Wuyang, the leaders of a bandit gang based in a nearby village, and joins them in raiding a rebel convoy for food supplies. That night, some imperial troops show up in the village and seize the supplies. Around this time, Pang starts a secret affair with Liansheng, Zhao's wife.

Since the villagers are poor and starving, Pang convinces them to form a militia and join imperial forces to suppress the rebellion. With Pang as their leader, the three men swear a blood oath and pledge loyalty to each other as brothers on the pain of death. Later, with minimal support from regular imperial forces, the militia scores a series of victories against the rebels. Over time, Pang becomes increasingly ambitious and prepares to attack the rebel-controlled city of Suzhou. However, Pang's imperial superiors have grown jealous of his success, so they start denying him reinforcements and supplies. As a result, the battle of Suzhou turns into a year-long siege in which the militia gradually runs out of food and supplies.

Zhao disguises himself and infiltrates Suzhou to assassinate the rebel commander, but learns that the commander is already planning to surrender. The commander allows Zhao to kill him on the condition that the imperials spare the lives of the rebels and civilians in the city. Meanwhile, Pang has managed to procure ten days' worth of supplies from a rival imperial commander. When he learns of the deal Zhao has made with the rebels, he refuses to honour it because the supplies are insufficient to support both the militia and the surrendered rebels. A dispute between Pang and Zhao ensues, after which Pang temporarily puts Zhao in chains to prevent him from interfering. Pang then orders Jiang to oversee the massacre of the surrendered rebels, and Jiang regretfully carries it out.

Embittered by Pang's decision, Zhao intends to desert the militia but Pang begs him to stay and points out that the massacre was necessary and they have to conserve their supplies for their next battle in Nanjing, the rebel capital city. If they win, they can stop the rebellion and prevent further bloodshed. Convinced that Pang's choices are for the greater good, Zhao reluctantly agrees. After the Battle of Nanjing which marks the end of the war, Pang is rewarded with the position of a viceroy by the imperial government. During this time, Pang and Zhao have grown apart due to mistrust, especially after Zhao oversteps his authority by distributing funds to their men without Pang's approval. Yet, Zhao refuses to turn against Pang when Pang's political rivals hint that he should.

Realising that he was losing control over Zhao and his men, Pang considers disbanding the militia and reluctantly plots Zhao's assassination as he fears that Zhao might cause trouble. When Jiang learns of Pang's plan, he tries to dissuade Pang and inadvertently discovers Pang's ongoing secret affair with Liansheng. Jiang blames Liansheng for breaking their brotherhood and kills her. Meanwhile, Zhao is tricked into thinking that Pang is in danger and goes to save him, only to fall into a trap and end up being killed without realising that it was Pang who wanted him dead.

After Jiang learns that Pang is responsible for Zhao's death, he attempts to kill Pang. Although Pang manages to fend off and defeat Jiang, he is fatally wounded by a sniper sent by his political rivals. As he collapses, he allows Jiang to deliver the ''coup de gr√¢ce'' and fulfil their oath. Offscreen, it is mentioned that Jiang is eventually arrested, made the scapegoat for Pang's assassination, and executed by ''lingchi''.

