During the late Ming dynasty, the imperial court is plagued by corruption and the reigning emperor is incompetent. The Embroidered Uniform Guard (''jinyiwei'') consists of orphans trained in cruel, clandestine combat since childhood and they serve as the Ming government's secret service. Qinglong, a ''jinyiwei'' commander, is given a mechanical box of 14 blades to help him in his duties. Jia Jingzhong, an imperial eunuch close to the emperor, secretly plots a rebellion with the emperor's uncle, Prince Qing, who has been exiled after an unsuccessful rebellion.

Jia Jingzhong orders Qinglong to retrieve a safe box in the possession of the imperial councillor, Zhao Shenyang, whom he accuses of planning a revolt; Qinglong is told that the box contains proof of the councillor's treason. However, Qinglong soon discovers that the box actually contains the Imperial Seal, a symbol of the emperor's authority, which Jia Jingzhong needs to legitimise Prince Qing's authority. Qinglong is betrayed by his fellow ''jinyiwei'' and his brother-in-arms, Xuanwu, who has secretly pledged allegiance to Jia Jingzhong. Prince Qing's adoptive daughter, Tuo-Tuo, a deadly warrior, arrives to lend her assistance on receiving news of Qinglong's escape. Qinglong, now a fugitive and unable to leave the city until his wounds heal, finds his way to the Justice Security Service, a private security company whose fortunes are dwindling. The owner eagerly accepts Qinglong's offer to pay him handsomely for safe passage in hopes of revitalising his business. By coincidence, the owner's daughter, Qiao Hua, is engaged to be married, and the security service hides Qinglong within her wedding carriage as a means of getting past the checkpoints and leaving the city.

When another group of ''jinyiwei'' arrives to arrest Qinglong, he fights and kills them but unknowingly reveals his identity as a former ''jinyiwei'' himself. Fearing more trouble than they bargained for, the owner offers to return Qinglong's money and asks to be left in peace. However, Qinglong is determined to fulfil his duty to the emperor so he takes Qiao Hua as a hostage. The pair arrive at Yanmen Pass, where Qinglong hopes to gather information. He discovers that his enemies intend to sell three provinces to fund their cause. While Qinglong investigates and plots his next move, the duo encounters the Heaven's Eagles Gang, a group of bandits led by the self-proclaimed "Judge of the Desert". The leader is a strong warrior who fights Qinglong, proving that they are evenly matched. Qinglong proposes an alliance to raid the outpost at Yanmen Pass; the gang will get their full cut of the booty while Qinglong gets to satisfy his personal objectives. Standing in Qinglong's way are Jia Jingzhong's henchmen and his former ''jinyiwei'', who have come to broker a deal with the gang. Before the raid is executed, Jia Jingzhong is betrayed and killed by Xuanwu, who intends to directly serve under Prince Qing.

Qinglong and the Heaven's Eagles Gang successfully raid the outpost and kill most of the soldiers. Qinglong overcomes Xuanwu in combat, but the latter escapes by yielding the Imperial Seal. Tuo-Tuo kidnaps Qiao Hua and demands the seal in return for freeing her. Qiao Hua is doubtful that Qinglong will make the trade, but Qinglong gives up the seal. However, he also makes it clear that he intends to take Qiao Hua to her fianc√©. Duty-bound to recover the seal, Qinglong leaves Qiao Hua. Qinglong fights Tuo-Tuo at a tavern and he witnesses her striptease tactic. Qinglong reunites with the Justice Security Service and they catch up with Qinglong, offering to assist with their superior knowledge of the roads. Separately, the Judge of the Desert realises the importance of the Seal and leaves his gang to pursue the seal on his own.

Intercepting Tuo-Tuo, Xuanwu and Prince Qing's men arrive at the ruins of the ancient Sky Wolves City. Qinglong draws Tuo-Tuo into chasing a disguised Qiao Hua. Subsequently, Xuanwu and Prince Qing's men are split up and lured into an ambush set by the Justice Security Service and are defeated by Qinglong and the service. Xuanwu plays on Qinglong's guilt and mercy to escape execution but then attempts to kill Qinglong when his back is turned, forcing his hand. Tuo-Tuo eventually catches up with Qiao Hua and tells her Qinglong set her up to die for him, but the Judge of the Desert intervenes.  Realizing he is no match for Tuo-Tuo, the Judge sacrifices himself in combat to enable Qiao Hua to escape. After reuniting with Qinglong, he gives the seal to her and instructs her to bring it to the authorities to alert them of Prince Qing's conspiracy. Qiao Hua tells Qinglong she has declined her wedding proposal, suggesting she wants to be with Qinglong, but he believes he is likely to die; he tells her they will meet again if she rings a bell bracelet he had previously given her. Qinglong and Tuo-Tuo duel to the death in an abandoned temple. The fight intensifies and Tuo-Tuo strips down to her last robe. After Tuo-Tuo stabs Qinglong, Qinglong grabs hold of Tuo-Tuo and uses his box of 14 blades to kill both Tuo-Tuo and himself.

In the aftermath, Prince Qing's rebellion fails. He mourns Tuo-Tuo's death and commits suicide before being brought to trial. Qiao Hua's father passes away and she inherits the Justice Security Service. During her travels, she frequently detours along the desert roads to remember her adventures with Qinglong. On one such foray, while looking across the desert with her spyglass and ringing her bell, she sees a man who appears much like Qinglong in the distance.

