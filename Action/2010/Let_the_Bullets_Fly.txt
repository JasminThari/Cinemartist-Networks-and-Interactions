Set in China during the warring 1920s, "Poxy" Zhang (张麻子; Jiang Wen) leads a group of bandits, each of whom is numbered rather than named, and ambushes a luxurious government tram engine and coach (curiously "pulled" by many horses) carrying Ma Bangde (马邦德; Ge You), who is on his way to Goose Town (鹅城 ''E-cheng'') to assume the position of county governor.  Ma's train is derailed, killing both his bodyguards and his adviser, Counsellor Tang (汤师爷 ''Tang-shiye''; Feng Xiaogang).  Ma has no money, having spent it all to bribe and buy his position.  To avoid being killed by Zhang's bandits, he lies to them claiming that he is Counsellor Tang and that his wife (Carina Lau) was the dead governor's wife.  He tells the bandits that, if they spare him and his wife, he will help Zhang to impersonate Ma and pilfer Goose Town's finances.

At Goose Town, Zhang's appointment is opposed by local mobster boss Master Huang (黄老爷 ''Huang-laoye''; Chow Yun Fat), who lives in a fortified citadel.  Huang greets the governor's party by sending his best hat in a palanquin instead of himself.  Ma tells Zhang that previous governors would split with Huang the majority of taxes levied from the town residents. However, Zhang is not interested in taking money from the poor.

Champion Wu (武举人 ''Wu-juren''; Jiang Wu), one of Huang's subordinates, severely injures a citizen, and as governor Zhang rules against Wu in the town court.  In retaliation, Huang frames Zhang's godson, Six (老六 ''Lao-liu''), for theft.  Six kills himself in the process of proving his innocence.  Zhang vows to destroy Huang, but Ma advises him to use cunning rather than brute force.  Huang invites Zhang to a meal at his citadel, and there Huang pretends to have his subordinates killed as a sign of good faith.  Not realizing the governor is actually the bandit chief, Huang raises a plan to hunt down and kill Zhang Mazi.  Zhang pretends to agree to this plan, so long as Huang finances the expedition.

That night, Huang disguises his subordinates as Mazi's bandits and sends them to assassinate Zhang while he is asleep.  However, only Ma's wife is killed.  In grief, Ma reveals his true identity as governor to Zhang.  During the funeral for Ma's wife, Zhang has his bandits kidnap Huang and the heads of Goose Town's two leading families for ransom.  They quickly discover they have captured Huang's look-alike.  The town raises the ransom money but Zhang refuses to take it, instead returning it to the townsfolk.  As they do so, Flora (花姐 ''Huajie''), a young prostitute in Huang's custody, discovers their identity.  She is captured by Zhang's gang but becomes friendly with Two (老二 ''Lao-er'') and Three (老三 ''Lao-san'') and later stays on as a bandit member, helping them to guard Huang's look-alike.  Huang sends his own subordinates, also disguised as bandits, to retrieve the money handed back to the town.

A random woman approaches Ma, claiming that he seduced her while in Shanxi, and that he is the father of her son. As compensation, Ma gives them two jewels.

Huang tries to kill Zhang again by sending subordinates to his house, disguised as masked bandits. The plan fails and Huang's men are shot to death. As such, Huang is forced to supply the money for Zhang's Anti Bandit Expedition. When Huang's steward obtains a portrait of the real Governor Ma, and Huang confronts Zhang, Ma confesses that he is the real governor, and pretends that Zhang is his nephew. As the Expedition goes ahead, Huang employs a fake Zhang Mazi to kill Zhang, and also sends men to plant a landmine on the road. In the ensuing battle, Two is killed, but the fake Zhang Mazi is captured. To avoid death, he offers Zhang two jewels, and admits that he obtained them by robbing and killing a woman and her son. Ma recognizes the jewels, and is filled with grief, and tries to travel to Shanxi, but drives over the landmine and is killed.

Zhang vows revenge and returns to Goose Town for a showdown with Huang.  He scatters money to the townsfolk and Huang gathers it up the next day; then Zhang scatters firearms to the townsfolk and prevents Huang from gathering them.  Zhang and his bandits put on a show of attacking the citadel, then publicly beheads Huang's look-alike to convince the townsfolk that Huang is dead and the one in the citadel is the look-alike. The townsfolk are reassured and storm the citadel with their new weapons.  Zhang gives Huang a gun with one bullet left for his own suicide.  However, a moment later, Huang stands on top of his own citadel and fires the gun into the air to get Zhang's attention.  He throws a hat better than the one he originally sent to greet Zhang off the roof, as he promised.  He then walks back into the citadel, killing himself with his own landmine.

Three intends to marry Flora and the surviving bandits leave for Shanghai to lead a more peaceful life.  They take the train through the mountains, Zhang riding after them.

