James King is a wealthy hedge fund manager at Barrow Funds, engaged to Alissa, the daughter of his boss Martin Barrow. During an engagement party for James and Alissa, the FBI arrive and arrest James for fraud and embezzlement. James' lawyer, Peter Penny, urges him to plead guilty for a likely shorter sentence, but James refuses under the belief that he will be exonerated. James is found guilty, however, and subsequently sentenced to 10 years in San Quentin State Prison, with the judge allowing him 30 days to get his affairs in order. On top of this, Alissa leaves James after he suggests the two flee the country together.

Over time, James has come to know Darnell Lewis, who operates a small car wash business in the parking lot used by James. Shortly after his arrest, James encounters Darnell and, assuming he has been incarcerated before because he is Black, begs him for help, requesting to be "toughened up". Darnell, who in actuality has never been to prison and has little experience in fighting, agrees, on the condition James pays him $30,000; Darnell sees it as an opportunity for him and his wife Rita to finally put their daughter Makayla in a better school, away from the bad neighborhood they live in.

Darnell's training, which includes pepper-spraying James, re-modelling his house to resemble a maximum security prison and creating multiple scenarios in which he must defend himself, all fail miserably. During the training, James gets in touch with Martin to tell him about his search for help. Martin, the actual crook, believes James is onto him and orders a hitman named Gayle to monitor him.

With James' training seemingly going nowhere, Darnell suggests that James should prepare in other ways for prison, and takes him to a gay hookup spot to teach James how to perform oral sex in prison. James can't go through with it and instead tells Darnell that he will keep going and do whatever it takes in order to "get hard". James soon after begins to work out harder and faster, makes shivs, learns "keistering" (smuggling contraband in the anus), and seems to be making progress. Darnell simulates a prison riot with help from James' domestic staff. In the chaos, James gets a shiv stuck in his head, after which, Darnell brings James to his home for Rita to treat it. James has dinner with Darnell's family and listens to the tale of how he ended up in prison, which is actually just a retelling of the movie ''Boyz n the Hood''.

James and Darnell resolve for James to join a local gang called the Crenshaw Kings to gain protection in prison. However, Darnell's cousin and gang leader Russell rebuffs James and redirects him to the Alliance of Whites gang. James is unable to portray a convincing racist, leading the gang to think he is a cop; they threaten to attack James, but Darnell rescues him by bursting in with a flamethrower.

Eventually, Darnell and James finally deduce that Martin is the crook, and the reason James is going to prison. They sneak into his office and find the embezzlement records on Martin's computer. Before they can expose him, Gayle finds them and takes back the computer, informing James that Darnell is not who he thinks he is and has never been in prison. Dejected and upset that Darnell lied to him, James returns to the Crenshaw Kings on his own, asking to join. They accept him as one of their own and order him to kill someone as his initiation. Before he can do so, Darnell arrives in time to convince James to expose Martin.

The two sneak onto Martin's yacht to retrieve the computer, only to come across Gayle and his men. James unleashes a series of capoeira moves on them before Martin and Alissa arrive, both confessing to the fraud and embezzlement, a scheme that also included Peter. They try to convince James to run away with them, but he turns them down and heads to a life raft with Darnell. When Gayle shoots the life raft, James pulls out a gun he had "keistered" and aims it at Gayle. U.S. Marshals suddenly appear, summoned by the ankle monitor that James triggered, having trespassed the county line.

Barrow's computer provides the evidence needed to clear James. Martin, Gayle, Alissa, and the henchmen are all arrested and James is exonerated. However, he still ends up getting six months for holding an unlicensed gun, but thanks to Darnell's training, James is fully prepared for his stint in prison. Martin is not; he is quickly attacked by inmates when his San Quentin sentence with Peter begins. James spends his sentence helping the FBI retrieve all the assets that Martin stole, while guiding Darnell's investments so that he and Rita are able to open their own carwash. As Darnell drives James home after his release, James announces his intent to celebrate his freedom with a ''Wall Street Journal'' and a forty, which he now considers a perfect Sunday.

